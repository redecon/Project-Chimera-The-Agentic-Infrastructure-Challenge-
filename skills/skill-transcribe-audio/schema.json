{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Skill: transcribe-audio - schema",
  "description": "Input and output contract for the transcribe-audio skill.",
  "type": "object",
  "definitions": {
    "input": {
      "type": "object",
      "oneOf": [
        { "required": ["audio_file_path"] },
        { "required": ["audio_url"] }
      ],
      "properties": {
        "audio_file_path": { "type": "string", "description": "Local file path to the audio asset." },
        "audio_url": { "type": "string", "format": "uri", "description": "Remote URL to fetch audio from." },
        "language": { "type": "string", "description": "Optional ISO language code hint (e.g., en-US)." },
        "model": { "type": "string", "description": "Optional transcription model identifier." },
        "diarize": { "type": "boolean", "default": false, "description": "Whether to attempt speaker diarization." }
      },
      "additionalProperties": false
    },
    "segment": {
      "type": "object",
      "properties": {
        "start_seconds": { "type": "number" },
        "end_seconds": { "type": "number" },
        "text": { "type": "string" },
        "speaker": { "type": ["string", "null"] },
        "confidence": { "type": ["number", "null"] }
      }
    },
    "successOutput": {
      "type": "object",
      "required": ["success","transcript"],
      "properties": {
        "success": { "type": "boolean", "enum": [true] },
        "transcript": { "type": "string", "description": "Full transcript text." },
        "format": { "type": "string", "description": "Transcript format (e.g., plain, srt, vtt)." },
        "segments": { "type": "array", "items": { "$ref": "#/definitions/segment" } },
        "language": { "type": "string" },
        "confidence": { "type": "number" },
        "error": { "type": ["null"] }
      },
      "additionalProperties": false
    },
    "failureOutput": {
      "type": "object",
      "required": ["success","error"],
      "properties": {
        "success": { "type": "boolean", "enum": [false] },
        "error": { "type": "string" }
      },
      "additionalProperties": false
    }
  },
  "oneOf": [ { "$ref": "#/definitions/successOutput" }, { "$ref": "#/definitions/failureOutput" } ],
  "examples": [
    {
      "input": { "audio_file_path": "/tmp/test.wav", "language": "en-US" },
      "output": { "success": true, "transcript": "Hello world", "format": "plain", "confidence": 0.95, "error": null }
    },
    {
      "input": { "audio_url": "https://cdn.test/missing.wav" },
      "output": { "success": false, "error": "File not found (HTTP 404)" }
    }
  ]
}
